pipeline {
    agent any
    
    environment {
        DOCKER_REGISTRY = 'nsamardzic/python_selenium_chrome'
    }
    
    
    parameters {
        string(name: "TEST_STRING", defaultValue: "staging", description: "This is for TEST_STRING")
        string(name: "GIT_REPO", defaultValue: "https://github.geo.conti.de/uia66114/jenkins_workshop.git", description: "This is GitHub repo")
        text(name: "TEST_TEXT", defaultValue: "One\nTwo\nThree\n", description: "This is for TEST_TEXT")
        booleanParam(name: "TEST_BOOLEAN", defaultValue: true, description: "This is for TEST_BOOLEAN")
        choice(name: "TEST_CHOICE", choices: ["one", "two", "three"], description: "This is TEST_CHOICE")
    }
    
    
    stages {
        
        stage("Parameters Check") {
            steps {
                script {
                    try {
                        sh """
                        uname -a
                        java -version
                        echo "$params.TEST_STRING"
                        echo "$params.TEST_TEXT"
                        echo "$params.TEST_BOOLEAN"
                        echo "$params.TEST_CHOICE"
                        echo "$params.TEST_PASSWORD"
                        """
                        echo 'Parameters shown'
                    } catch (err) {
                        echo 'Parameters shown failed'
                        currentBuild.result = 'SUCCESS'
                    }
                }
                
            }
        }
        
        
        
        
        stage('Checkout to specific branch') {
            options {
                timeout(time: 3, unit: 'SECONDS')
            }
            steps {
                script {
                    try {
                        checkout([
                            $class: 'GitSCM', 
                            branches: [[name: '*/master']], 
                            // branches: [[name: env.GIT_BRANCH]], 
                            userRemoteConfigs: [
                                [url: 'https://github.geo.conti.de/uia66114/jenkins_workshop.git'],
                                [url: "$params.TEST_STRING"],
                                [name: 'master'],
                                [credentialsId: 'Jenkins_Git_Account_ID'],
                                [refspec: '+refs/heads/master:refs/remotes/origin/master']]
                        ])
                        echo 'SVN checkout SUCCESS'
                    } catch (err) {
                        echo 'SVN checkout Failed'
                        currentBuild.result = 'SUCCESS'
                    }
                }
            }
        }
        
        
            
            
            
            
        stage('Run preconfigured Test Suite') {
            options {
                timeout(time: 2, unit: 'HOURS')
            }
            steps {
                script {
                    try {
                        // sleep(time:10, unit:'SECONDS')
                        sh """
                        cd ${WORKSPACE}
                        ls -l
                        """
                        // sh """
                        // cd /Users/uib54845/jenkins_workshop
                        // ls -l
                        // """
                        
                        echo 'Directory listing success'
                    } catch (err) {
                        echo 'Directory listing success failed'
                        currentBuild.result = 'SUCCESS'
                    }
                }
            }
        }
        
        
        
        
    }
}